#!/usr/bin/env python

from python_speech_features import mfcc
from python_speech_features import delta
from python_speech_features import logfbank
from scipy.cluster.vq import vq, kmeans, whiten

import scipy.io.wavfile as wav
import scipy.cluster.vq as cluster


(rate,sig) = wav.read("5.wav")




# print(mfcc_feat)

import matplotlib.pyplot as plt
import numpy as np

java=[[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[-32.23619131946497,-7.291485022182475E-14,3.203811571794759E-13,5.54037967520248E-13,4.936175196243349E-13,5.246023182833656E-13,0.0,-1.821438797325746E-13,-3.12807968296616E-13,-1.847230002522253E-12,-8.446957523269034E-13,-2.5153212845907547E-12,3.843365673087411E-12],[4.917765198052331,-55.3446292719445,-7.4146400596569375,-1.2308132063072843,48.54922079967103,29.629364297818352,-4.5153538271806095,-14.518667781411068,-10.425515485157863,-3.634471602036973,54.04095940567942,52.656235881305655,71.33123307870896],[5.730730415910235,-52.729864285567146,1.4993975323567714,-6.048742424954712,41.69970962968738,30.225284232501366,14.42665146846779,-2.883389271270647,9.182856571713327,10.145952125314894,40.530308635304166,31.727826382897575,33.974489654027074],[6.512432258155058,-58.943606412156015,15.113494357265285,7.196507853619471,25.53429905483387,30.762137882290762,22.960516106437364,2.944545782187502,13.899785528918036,33.775004223510855,14.138317293041894,9.134931293440454,2.6845759738017656],[7.318764787579704,-42.45395319753101,23.77758882317494,8.526544805210959,31.025716745872053,8.910770548429355,4.728800814931379,3.6651208456337008,33.73649788123335,53.12502831710498,7.195250951571941,27.52424010618654,43.40818807101165],[8.332081731498873,-24.442548995949352,31.577964515823084,-5.197605159983147,24.496524496837917,-3.50553135553888,18.36062611171445,15.868253117587846,-3.277974386713763,17.828998753166243,-38.47355748831629,-18.06282791810954,19.52326013984981],[9.572268090392088,-12.284347616633678,32.57978775588674,-27.08677325662682,33.40132034443144,-14.37864497249321,6.362305919918555,30.712336303936038,-12.644509668947444,6.136811634686058,9.461321121005483,-12.65671652264622,-4.615036184299739],[10.537318775187225,-2.4958488215405343,40.54815837760268,-15.519927037786658,53.90883392323931,-9.222874447228316,18.347661301062214,23.907718074579126,-13.104955718217314,30.309670848818357,12.95585562487517,16.748892316173404,1.1078718269341776],[10.957594631518123,0.28677656664721035,39.1914494697339,-13.76244196356079,47.022043744502085,-12.901519699385034,11.893878025832038,6.150997223966314,-16.315450593605103,35.35412420399451,6.5346874995604,35.384536620564475,13.245307075247498],[11.074637427215878,4.590594859551031,32.441731306975285,-24.017519635209847,37.651406622335536,-5.984754196769147,25.344707603629416,16.52974891805078,-11.911123975807186,27.197374858072777,-25.427031800346718,22.874453430865557,35.069843892459026],[11.450689840034485,-3.097685305198646,13.307762862838398,-23.43210681298377,31.373841282729693,15.119466298040672,9.935645952217259,14.12549025040617,-23.194171267029414,-6.644767803692696,2.407146435141971,57.82005033417458,5.441716934196129],[11.467313473552654,-10.090192354956336,6.895696292277777,-25.575929739373002,35.81196134242923,13.859246015662805,1.0202255959881352,9.332911380641512,-31.64245046102826,-12.274907143917117,0.6290874555325474,45.77536869031145,7.570833706539476],[11.268378878958687,-8.804839381214505,33.090523963349526,-15.84787881339525,35.34677811048695,-0.7603166980735826,4.398846979555027,32.62163807943377,12.461241942259388,31.01384256001489,-20.17809409497193,8.706111797893804,13.680226201703073],[11.548549068684913,-2.854827055615101,44.568081172683115,-7.2843442832657255,29.52931158483737,1.1280554236781655,9.84926948620078,34.14123318809074,15.70911764703323,38.17309699017688,-0.6403844698405925,19.3136166001852,26.774193690007472],[11.561756554406509,-2.691034947922893,40.529186502256756,-8.260411858384208,26.655287610095165,8.812567018607027,16.061499777511415,20.955109481916676,2.4001274251630456,39.578332676443345,-0.24240603794829754,6.262534130248074,28.935919368384177],[11.592610184408883,-3.0175510938532892,40.51099270029213,-12.92930171362187,21.945337324513954,7.023248073982881,23.709382628917435,17.346899911686133,-1.544390923081401,34.09655451154627,7.322576044191843,7.700440888254565,23.937735312723028],[11.751099793232475,6.512409817989345,50.01485125305833,-6.0177436047916535,29.797904078878158,4.526533228055287,3.8686521950522628,-3.0842028209073136,-24.880805237267317,34.397360591052085,-1.6554908536018722,21.964710983944887,25.441260761710765],[11.582963456162302,0.8575664476304173,48.972266310843416,0.7247334230392336,41.08586525021101,5.592099400413492,-2.66069359850491,-6.950245219720709,-27.629870249489024,38.59354057242312,-14.972235760291525,26.704519814305968,15.216502330038349],[11.558902606410424,-5.4822866595240205,29.00084358856568,-30.104746584849234,22.94743640580325,-14.34165131351733,-2.507429426051758,7.931225675031508,-0.4025590870740077,37.10690428028669,-17.265549237988836,18.213407726415152,14.632767152892493],[11.581832929506511,2.1598156741186707,31.45443515473334,-34.754127842402866,28.743257425226833,-13.174644373135326,3.2230235880279583,13.442836088993014,-6.631629914358401,37.85089392289557,-22.27138424587996,6.806551146705814,-5.206318646578319],[11.666405966088599,2.1469445589061285,35.83374019745445,-23.670135832629715,50.28806989915068,-2.570232501886615,22.1819688919935,28.13441369765387,-12.905404470438143,34.90802314044713,-12.17881776821268,-9.418824145911387,15.447551751903005],[11.76381083657523,0.9896619573085025,43.59492032594762,-28.747493328193592,43.961725126919994,-1.6657272939146321,22.421306295154213,34.620630184084376,5.110892469022646,54.615620668263276,2.7620422603285055,-22.438226656570397,-13.934317574545823]]
java+=[[12.147299269925663,3.4791222917953353,39.979770180581106,-20.458613073055716,33.63436998846292,1.5556279594979465,-3.095672329038174,29.759208958980242,3.9603533778677544,48.07355938879367,-10.38654301367343,14.312286972199455,3.4079894560660753],[12.15759127475957,4.360033516347888,45.14996851369348,-19.409681859772174,38.48457588233115,-8.241138060893864,4.217070146877648,24.318428585035907,3.0320362225663082,62.535272696058975,16.456681469293706,22.135993333787823,9.88090440887772],[11.976178615468807,1.9045665565898169,42.81263136692238,-23.427135882699613,27.387856036228158,-3.3447819911436207,9.1618319588097,27.810028978464253,2.6175665470439844,72.16871324135661,16.10475903391943,8.801137629686583,-1.1146031177991225],[12.064739361991364,-4.248510018600348,41.81788580330118,-24.478614161454104,28.13283582571815,-12.87298612758758,-6.73980434726429,15.482136109436402,-10.559990967908034,38.47074949590494,-14.632964631299227,8.422814426347841,1.8130427460472787],[12.19368353588888,1.6954427929046294,46.77058699065436,-18.3989703512524,31.71710579801831,-10.29090391694438,0.2845976159613555,23.310952278695634,3.0188185890231662,58.040511134710236,-20.07812872095023,-26.509580207839498,-28.18998427166312],[12.366846621674739,-2.057411294366014,46.10551864442366,-9.089453694977449,27.18357388983588,2.862133268823608,-9.212236972262001,27.182902357985373,-7.121458620619805,51.647028247209064,12.157882210370966,-26.838058722782545,1.3459218059464708],[12.331903187798112,-8.62198182164986,26.921483863148424,-6.7941399402246825,23.28389583821794,0.561482693439453,-12.37074019810312,43.29748544204996,-4.54402284348371,34.30809882984682,19.418391786459235,4.014209808170882,14.982764113809909],[12.415338714138318,-17.672509666295003,23.041782560985347,9.877137610199716,27.948320592129413,9.60518953209362,-5.914078057926775,48.25703079493214,-13.879239802794524,11.649078088385634,-12.136256833641587,2.3941138278984084,17.62535007456288],[12.590412350606693,-17.616395580745582,21.950013074290776,4.274091618807992,24.433874281799206,5.29897708223233,-5.724092439730348,55.175929004579125,-25.55057105676639,16.106923744641144,4.337339837113794,6.873047570393492,21.89270734198278],[12.561746887498886,-15.082482196513597,23.897816428225042,-0.8630292818533023,19.725491385723306,8.243024480394757,-2.368515046619708,50.32055619617428,-14.801599027730838,46.56921789052017,36.72369569538679,1.5076919706183922,3.0923024439223004],[12.2863306307751,-9.561545158788027,23.301070270797013,-19.20568619793243,20.042238134867375,-3.3616420683300032,7.497392463267784,40.86938680523153,0.16309182369821432,47.28564917975736,24.39494461492168,9.260115264636713,18.73995443795884],[12.159514354345957,-1.4746025315976585,36.62822699274094,-20.990379922424115,28.589033207061718,-14.418609354056713,-6.597436649523722,23.713650831122216,3.2767630623697994,35.493132907665355,19.705027894978333,39.77783567674503,17.729151021401808],[12.166063465548646,-3.297985203709674,43.68587623656724,-13.339109194122308,35.4484178274544,9.29302581537578,-3.6698278252485164,35.29575611376552,20.108380113719754,41.98767778944766,10.64386032015781,3.36193416464074,-8.49533180102491],[12.306436126002426,-6.010964442794045,43.16188698080854,-16.990443904100555,11.909069549197113,8.308260466035215,1.8759251685718017,29.367522419833758,6.930652322090577,52.487330104701456,3.099834788469414,3.684304999356165,17.641449252689316],[12.371578907703965,-1.6278633849673936,46.63041005429951,-22.549953556885384,15.433726274500506,21.847291950898217,10.210395385038373,-4.3459118382129125,-7.925299138662042,56.04367737850666,3.283959601582345,20.02117367716354,15.116928639118273],[12.297379075348912,1.0144688947680902,44.63204783262175,-28.80803327149685,28.431338709815584,20.520071533639644,8.26945633489525,-13.08703098535979,-1.9758099235900943,60.324058292284064,-7.058138678937835,30.282484474302887,-4.0471909334762906],[12.342827996487735,-1.9583043265526594,47.538220793408456,-8.419038568859206,41.372957454608795,34.874525452280395,23.724901269960085,18.399759999812048,5.054218386068387,42.26953573738466,-2.5315768755595514,3.38979107543825,-17.23140628024253],[14.365306864303093,-38.73822481441325,36.4956586854106,36.79182409205002,-2.722491106551876,30.8438103634243,-16.217334030457067,50.00265964889387,-53.3727625221677,81.77761922660171,-51.141027319892885,6.828074891469324,55.17107384803498],[14.372184243320698,-37.31027243492319,36.06702460874037,36.57027693275788,-0.8994936020810733,36.17295456731213,-15.646535914895914,48.202919613765694,-57.306170387345894,80.01525530985853,-48.7913406028354,15.38690134640882,64.1103219478525],[12.400596351811862,-1.565777074034121,44.90455922057201,-7.208027418393512,46.66805827606792,16.487650077461232,16.40680127835226,9.641652992576518,-22.535000972191742,47.77004588752752,7.157901639586315,-1.5059109235281767,14.850427877808038],[12.296002602783664,1.7220714874272818,40.27807661481811,-23.34889349423508,33.09430210973748,-5.766326293411529,10.197711572675995,11.520210367276396,-19.36836819176164,49.792416931798634,-9.165146172291333,-13.27147105343198,10.724268068813492],[12.328405790221959,4.712833385123912,42.443581031757546,-28.22282293493382,36.369705862471655,-14.860034188602496,12.481020281843998,25.95982218433063,-3.5543137737363097,61.56121814569038,9.466410317879374,7.3733504648482295,12.49953177245127],[12.343028054041817,6.744441199870175,41.39552825074442,-32.654184854282406,45.54447142602844,-3.509146869647773,8.949705118337524,19.575086025163785,5.233401218349268,67.53744463770605,37.14626133237397,36.35861942958786,32.42131008319954],[12.30134298713194,10.86033491421213,40.60185675474047,-36.55590247168307,49.42676628150521,-0.15362744856146518,19.904697903317402,23.14894524225107,-11.14186593817536,48.38175821884189,11.110426421964949,-9.98542213942364,4.3384927697072255],[12.419004130962552,12.50621028221364,44.13687481374533,-26.176912990142494,44.96100275637853,-1.1583170817949744,2.3225991883609756,10.706849353707714,-4.153608329491829,50.20347284353628,-3.0301233352519334,-15.450995105005145,-3.4604481606515995],[12.491959125018445,1.48069887076699,47.41618078943877,-18.113982006377235,36.55983810790742,18.94950539990382,-0.4738239384293628,17.810521750040323,-11.545045666519698,29.213336287022333,-12.146772424489242,-6.414065171972538,-1.1208678476745189],[12.712216567887705,-9.426344434891362,39.60288466931847,-6.7085967205206645,24.13558476479102,37.90570986293174,10.237313974071808,29.23481532529444,-15.046368483256337,20.3139461146589,-14.977195321984922,29.31068775206221,12.33838675944872],[12.886505072518883,-19.40678199136499,19.950026248825743,0.7788598987406438,-1.593400118004047,15.356009129877467,27.36530976013246,23.37407840062666,-6.043411583567676,47.43920357075786,0.010580146783087543,10.356868733729566,-7.774185429578237],[13.48769172110407,-38.169210235917774,10.154839056622613,27.1112160880113,18.008821895144873,21.71588408579596,15.280321135195543,13.040606936973479,7.6781573619884576,47.94939658139711,3.089865105642286,4.70504505603347,2.540326793359379],[14.149419067025779,-45.439975856300045,8.676715977989245,26.356085880181663,6.276096684720878,18.749689992637872,-3.866843608259331,15.424558859490327,-4.59014446858635,29.56243817054594,-1.7801832021379125,-1.68915813241113,13.592069842116818],[14.372031385188098,-54.48759714249648,6.036381680075641,35.15428824010132,17.35107293890892,26.31778021564218,-0.3722167451575394,18.232757406408172,-15.97223996296008,20.13802012754271,-2.596239999146253,11.264092631586003,34.3762789874739],[14.141356497905067,-49.53032876484296,17.603317300306244,39.52540066718212,-10.085875826637695,1.1771956352025463,-3.014912057915374,21.7988771737879,-23.252592723275818,29.20139377271622,1.4319773973072447,36.60755700444543,29.483597524843276],[13.633253092323331,-36.037231724634815,20.444093021448957,14.807359314020296,-27.393986254067137,13.523761186377266,-6.202519476510215,28.186298492004223,-13.021238554898549,50.62701948936316,-6.931151192185367,34.5775041788563,41.787252754694904],[12.872550631837758,-17.356601645410144,37.03533409618702,-11.551563140686184,-10.313584377227082,14.710540334194492,-4.296088113740452,29.129530170105703,-22.95520440369688,57.18687514558101,5.444155074108112,-10.193871547457988,19.307753027926584],[12.760245433158184,-12.17421920112921,9.139247249075952,-25.842495736878476,32.70891981417306,-0.44633854886225677,-17.02796659000158,4.876083169502157,-15.993116788431779,55.83046162142905,-0.35691574614495475,-29.104925937721816,0.8588938671543825]]
for a in java:
    plt.plot(a)
plt.show()

# fbank_feat = logfbank(sig,rate,nfft=1024)
mfcc_feat = mfcc(sig,rate,nfft=1024)

# for a in mfcc_feat:
#     plt.plot(a)
#
plt.xlabel("asdfasdfs")
plt.show()

# d_mfcc_feat = delta(mfcc_feat, 2)


#print(len(mfcc_feat))
#for i in range(10,len(mfcc_feat)):
 #   plt.plot(mfcc_feat[i])

#plt.show()


codebook, distortion = kmeans(mfcc_feat,3)


plt.scatter(mfcc_feat[:, 0], mfcc_feat[:, 1])
plt.scatter(codebook[:, 0], codebook[:, 1], c='r')
plt.show()

from scipy import spatial
tree = spatial.KDTree(codebook)
list=[]
for point in mfcc_feat:
    list.append(tree.query(point)[1])

plt.plot(list)
plt.show()
